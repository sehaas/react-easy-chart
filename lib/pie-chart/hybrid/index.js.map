{"version":3,"sources":["../../../modules/pie-chart/hybrid/index.js"],"names":["color","schemeCategory20","domain","pie","value","d","sort","getSliceFill","i","data","getLabelText","key","PieChart","PropTypes","array","isRequired","innerHoleSize","number","size","padding","labels","bool","styles","object","mouseOverHandler","func","mouseOutHandler","mouseMoveHandler","clickHandler","props","uid","currentSlices","currentLabels","tweenSlice","slice","index","currentSlice","t","getSliceArc","initialise","transition","innerRadius","getInnerRadius","outerRadius","getOuterRadius","radius","datum","selectAll","node","ReactFauxDOM","Element","setAttribute","text","getLabels","getLabelArcTransform","getLabelArc","centroid","labelX","labelY","enter","append","attr","each","push","mouseover","lastEvent","mouseout","mousemove","click","path","getSlices","on","initialiseSlices","initialiseLabels","n","length","duration","attrTween","splice","exit","remove","transitionSlices","transitionLabels","root","scope","rules","defaultStyles","createSvgNode","createSvgRoot","p","calculateChartParameters","createSlices","createLabels","className","createStyle","toReact","PureComponent"],"mappings":"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","file":"index.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport {\n  scaleOrdinal,\n  schemeCategory20,\n  range,\n  pie as layout,\n  arc,\n  select,\n  event as lastEvent,\n  interpolate\n} from 'd3';\nimport {\n  createUniqueID,\n  defaultStyles\n} from '../../shared';\nimport ReactFauxDOM from 'react-faux-dom';\nimport PropTypes from 'prop-types';\nimport { Style } from 'radium';\nimport merge from 'lodash.merge';\n\nconst color = scaleOrdinal(schemeCategory20).domain(range(0, 20));\nconst pie = layout()\n  .value((d) => d.value)\n  .sort(null);\n\nconst getSliceFill = (d, i) => (\n  (d.data.color)\n    ? d.data.color\n    : color(i));\n\nconst getLabelText = (d) => d.data.key;\n\nexport default class PieChart extends PureComponent {\n  static get propTypes() {\n    return {\n      data: PropTypes.array.isRequired,\n      innerHoleSize: PropTypes.number,\n      size: PropTypes.number,\n      padding: PropTypes.number,\n      labels: PropTypes.bool,\n      styles: PropTypes.object,\n      mouseOverHandler: PropTypes.func,\n      mouseOutHandler: PropTypes.func,\n      mouseMoveHandler: PropTypes.func,\n      clickHandler: PropTypes.func\n    };\n  }\n\n  static get defaultProps() {\n    return {\n      size: 400,\n      innerHoleSize: 0,\n      padding: 2,\n      labels: false,\n      styles: {},\n      mouseOverHandler: () => {},\n      mouseOutHandler: () => {},\n      mouseMoveHandler: () => {},\n      clickHandler: () => {}\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.uid = createUniqueID(props);\n    this.currentSlices = [];\n    this.currentLabels = [];\n    this.tweenSlice = (slice, index) => {\n      const currentSlice = this.currentSlices[index];\n      const i = interpolate(currentSlice, slice);\n      this.currentSlices[index] = slice;\n      return (t) => this.getSliceArc()(i(t));\n    };\n  }\n\n  componentDidMount() {\n    this.initialise();\n  }\n\n  componentDidUpdate() {\n    this.transition();\n  }\n\n  getSliceArc() {\n    const {\n      padding\n    } = this.props;\n\n    const innerRadius = this.getInnerRadius();\n    const outerRadius = this.getOuterRadius();\n\n    return arc()\n      .innerRadius(innerRadius - padding)\n      .outerRadius(outerRadius - padding);\n  }\n\n  getLabelArc() {\n    const {\n      padding\n    } = this.props;\n\n    const outerRadius = this.getOuterRadius();\n    const radius = outerRadius - padding - ((20 * outerRadius) / 100);\n\n    return arc()\n      .outerRadius(radius)\n      .innerRadius(radius);\n  }\n\n  getOuterRadius() {\n    return this.props.size * 0.5;\n  }\n\n  getInnerRadius() {\n    return this.props.innerHoleSize * 0.5;\n  }\n\n  getSlices() {\n    const {\n      data\n    } = this.props;\n\n    const uid = this.uid;\n\n    return select(`#slices-${uid}`)\n      .datum(data)\n      .selectAll('path');\n  }\n\n  getLabels() {\n    const {\n      data\n    } = this.props;\n\n    const uid = this.uid;\n\n    return select(`#labels-${uid}`)\n      .datum(data)\n      .selectAll('text');\n  }\n\n  createSvgNode({ size }) {\n    const node = new ReactFauxDOM.Element('svg');\n    node.setAttribute('width', size);\n    node.setAttribute('height', size);\n    return node;\n  }\n\n  createSvgRoot({ node }) {\n    return select(node);\n  }\n\n  initialiseLabels() {\n    const text = this.getLabels()\n      .data(pie);\n\n    const getLabelArcTransform = (d) => {\n      const [labelX, labelY] = this.getLabelArc().centroid(d);\n      return `translate(${labelX}, ${labelY})`;\n    };\n\n    const currentLabels = this.currentLabels;\n\n    text\n      .enter()\n      .append('text')\n      .attr('dy', '.35em')\n      .attr('class', 'pie-chart-label')\n      .attr('transform', getLabelArcTransform)\n      .text(getLabelText)\n      .each((d) => currentLabels.push(d));\n  }\n\n  initialiseSlices() {\n    const {\n      mouseOverHandler,\n      mouseOutHandler,\n      mouseMoveHandler,\n      clickHandler\n    } = this.props;\n\n    const mouseover = (d) => mouseOverHandler(d, lastEvent);\n    const mouseout = (d) => mouseOutHandler(d, lastEvent);\n    const mousemove = (d) => mouseMoveHandler(d, lastEvent);\n    const click = (d) => clickHandler(d, lastEvent);\n\n    const currentSlices = this.currentSlices;\n\n    const path = this.getSlices()\n      .data(pie);\n\n    path\n      .enter()\n      .append('path')\n      .attr('class', 'pie-chart-slice')\n      .attr('fill', getSliceFill)\n      .attr('d', this.getSliceArc())\n      .on('mouseover', mouseover)\n      .on('mouseout', mouseout)\n      .on('mousemove', mousemove)\n      .on('click', click)\n      .each((d) => currentSlices.push(d));\n  }\n\n  initialise() {\n    const {\n      labels\n    } = this.props;\n\n    this.initialiseSlices();\n\n    if (labels) {\n      this.initialiseLabels();\n    }\n  }\n\n  transitionSlices() {\n    const {\n      data,\n      mouseOverHandler,\n      mouseOutHandler,\n      mouseMoveHandler,\n      clickHandler\n    } = this.props;\n\n    const mouseover = (d) => mouseOverHandler(d, lastEvent);\n    const mouseout = (d) => mouseOutHandler(d, lastEvent);\n    const mousemove = (d) => mouseMoveHandler(d, lastEvent);\n    const click = (d) => clickHandler(d, lastEvent);\n\n    const n = data.length;\n    const currentSlices = this.currentSlices;\n\n    const path = this.getSlices()\n      .data(pie);\n\n    if (n) { // we don't need to do this, but it's fun\n      /*\n       * Change current slices\n       * Transition current slice dimensions\n       */\n      path\n        .attr('fill', getSliceFill)\n        .on('mouseover', mouseover)\n        .on('mouseout', mouseout)\n        .on('mousemove', mousemove)\n        .on('click', click)\n        .transition()\n        .duration(750)\n        .attrTween('d', this.tweenSlice);\n\n      /*\n       * Add new slices\n       */\n      path\n        .enter()\n        .append('path')\n        .attr('class', 'pie-chart-slice')\n        .attr('fill', getSliceFill)\n        .on('mouseover', mouseover)\n        .on('mouseout', mouseout)\n        .on('mousemove', mousemove)\n        .on('click', click)\n        .each((d, i) => currentSlices.splice(i, 1, d))\n        .transition()\n        .duration(750)\n        .attrTween('d', this.tweenSlice);\n    }\n\n    /*\n     * Remove old slices\n     */\n    path\n      .exit()\n      .remove();\n\n    currentSlices.length = n; // = this.currentSlices.slice(0, n)\n  }\n\n  transitionLabels() {\n    const {\n      data\n    } = this.props;\n\n    const getLabelArcTransform = (d) => {\n      const [labelX, labelY] = this.getLabelArc().centroid(d);\n      return `translate(${labelX}, ${labelY})`;\n    };\n\n    const n = data.length;\n    const currentLabels = this.currentLabels;\n    const text = this.getLabels()\n      .data(pie);\n\n    if (n) { // we don't need to do this, but it's fun\n      /*\n       * Change current labels\n       */\n      text\n        .transition()\n        .duration(750)\n        .attr('transform', getLabelArcTransform)\n        .text(getLabelText);\n\n      /*\n       * Add new labels\n       */\n      text\n        .enter()\n        .append('text')\n        .attr('dy', '.35em')\n        .attr('class', 'pie-chart-label')\n        .attr('transform', getLabelArcTransform)\n        .text(getLabelText)\n        .each((d, i) => currentLabels.splice(i, 1, d))\n        .transition()\n        .duration(750);\n    }\n\n    /*\n     * Remove old labels\n     */\n    text\n      .exit()\n      .remove();\n\n    currentLabels.length = n;\n  }\n\n  transition() {\n    const {\n      labels\n    } = this.props;\n\n    this.transitionSlices();\n\n    if (labels) {\n      this.transitionLabels();\n    }\n  }\n\n  createSlices({ root }) {\n    const uid = this.uid;\n    const radius = this.getOuterRadius();\n\n    root\n      .append('g')\n      .attr('id', `slices-${uid}`)\n      .attr('transform', `translate(${radius}, ${radius})`);\n  }\n\n  createLabels({ root }) {\n    const uid = this.uid;\n    const radius = this.getOuterRadius();\n\n    root\n      .append('g')\n      .attr('id', `labels-${uid}`)\n      .attr('transform', `translate(${radius}, ${radius})`);\n  }\n\n  createStyle() {\n    const {\n      styles\n    } = this.props;\n\n    const uid = this.uid;\n    const scope = `.pie-chart-${uid}`;\n    const rules = merge({}, defaultStyles, styles);\n\n    return (\n      <Style\n        scopeSelector={scope}\n        rules={rules}\n      />\n    );\n  }\n\n  calculateChartParameters() {\n    const {\n      size\n    } = this.props;\n\n    const node = this.createSvgNode({ size });\n    const root = this.createSvgRoot({ node });\n\n    return {\n      node,\n      root\n    };\n  }\n\n  render() {\n    const {\n      labels\n    } = this.props;\n\n    const p = this.calculateChartParameters();\n\n    this.createSlices(p);\n\n    if (labels) {\n      this.createLabels(p);\n    }\n\n    const uid = this.uid;\n    const className = `pie-chart-${uid}`;\n    const {\n      node\n    } = p;\n\n    return (\n      <div className={className}>\n        {this.createStyle()}\n        {node.toReact()}\n      </div>\n    );\n  }\n}\n"]}